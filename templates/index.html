<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Japan Tax Calculator</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    /* --- CSS Variables for Easy Theming --- */
    :root {
      --primary-color: #007bff;
      --background-color: #f4f7fc;
      --container-bg: #ffffff;
      --text-color: #34495e;
      --label-color: #2c3e50;
      --input-bg: #fdfdfd;
      --input-border: #dcdfe6;
      --input-focus-border: #007bff;
      --readonly-bg: #eef5ff;
      --tooltip-bg: #333;
      --success-color: #27ae60;
      --danger-color: #e74c3c;
      --shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
      --border-radius: 12px;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background-color: var(--background-color);
      color: var(--text-color);
      margin: 0;
      padding: 20px;
    }

    .container {
      max-width: 800px;
      margin: 40px auto;
      background: var(--container-bg);
      padding: 40px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
    }

    h1 {
      text-align: center;
      color: var(--label-color);
      margin-bottom: 8px;
      font-weight: 600;
    }

    .subtitle {
      text-align: center;
      color: #7f8c8d;
      margin-bottom: 35px;
    }
    
    /* --- Form Group & Grid Layout --- */
    .form-group {
      margin-bottom: 25px;
    }

    .input-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 20px;
    }
    
    @media (min-width: 600px) {
      .input-grid {
        grid-template-columns: 1fr 1fr;
      }
    }

    label {
      font-weight: 500;
      display: inline-block;
      margin-bottom: 8px;
      color: var(--label-color);
    }

    input, select {
      width: 100%;
      padding: 14px;
      border: 1px solid var(--input-border);
      border-radius: 8px;
      background-color: var(--input-bg);
      font-family: 'Poppins', sans-serif;
      font-size: 16px;
      transition: border-color 0.3s, box-shadow 0.3s;
      box-sizing: border-box; /* Important for consistent sizing */
    }

    input:focus, select:focus {
      outline: none;
      border-color: var(--input-focus-border);
      box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.15);
    }

    input[readonly] {
      background-color: var(--readonly-bg);
      font-weight: 500;
      color: var(--primary-color);
      border-color: #c9e2ff;
    }

    /* --- Icons & Tooltips --- */
    .label-with-icon {
      position: relative;
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }
    
    .label-with-icon .icon {
      font-size: 20px;
    }
    
    .label-with-icon .deduction-icon { color: var(--danger-color); }
    .label-with-icon .result-icon { color: var(--success-color); }

    .info-icon {
      font-size: 14px;
      color: #a0aec0;
      cursor: pointer;
      border: 1px solid #e2e8f0;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-style: normal;
      font-weight: bold;
      user-select: none; /* Prevents text selection on click */
    }
    .info-icon:hover + .tooltiptext {
      opacity: 1;
      visibility: visible;
      transform: translate(-50%, 5px);
    }
    .tooltiptext {
      visibility: hidden;
      opacity: 0;
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translate(-50%, 15px);
      background-color: var(--tooltip-bg);
      color: #fff;
      padding: 10px 15px;
      border-radius: 6px;
      white-space: normal;
      width: 280px;
      text-align: left;
      font-size: 13px;
      font-weight: 400;
      z-index: 10;
      transition: opacity 0.3s, transform 0.3s;
    }

    /* --- Language Toggle --- */
    .lang-toggle {
      text-align: center;
      margin-bottom: 30px;
      background-color: #e9ecef;
      border-radius: 8px;
      display: inline-block;
      padding: 4px;
      width: fit-content;
      margin-left: auto;
      margin-right: auto;
      display: flex;
    }
    .lang-toggle button {
      background-color: transparent;
      border: none;
      padding: 8px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      color: #495057;
      transition: background-color 0.3s, color 0.3s;
    }
    .lang-toggle button.active {
      background-color: var(--primary-color);
      color: white;
      box-shadow: 0 2px 5px rgba(0, 123, 255, 0.3);
    }

    hr {
      border: none;
      border-top: 1px solid #e2e8f0;
      margin: 40px 0;
    }
    
    /* --- Results Section Grid --- */
    .results-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 25px;
    }
    
    @media (min-width: 768px) {
        .results-grid {
            grid-template-columns: 1fr 1fr;
        }
    }

    footer {
      text-align: center;
      margin-top: 40px;
      color: #aaa;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div style="text-align: center;">
      <div class="lang-toggle">
        <button id="btn-en" class="active" onclick="toggleLanguage('en')">EN</button>
        <button id="btn-jp" onclick="toggleLanguage('jp')">JP</button>
      </div>
    </div>

    <h1 id="main-title">Japan Tax Calculator</h1>
    <p class="subtitle" id="subtitle">A simple and visual breakdown of your Japanese tax components.</p>

    <!-- --- SALARY INPUT --- -->
    <div class="input-grid">
      <div class="form-group">
        <label for="input-mode" id="label-input-type">Select Input Type:</label>
        <select id="input-mode" onchange="updateInputMode()">
          <option value="monthly" id="option-monthly">Monthly Gross Salary</option>
          <option value="annual" id="option-annual">Annual Gross Salary</option>
        </select>
      </div>
    </div>
    
    <div class="input-grid">
        <div id="monthly-group">
          <div class="form-group">
            <div class="label-with-icon">
              <label for="monthly" id="label-monthly">Monthly Gross Salary (¬•)</label>
            </div>
            <input type="number" id="monthly" oninput="syncSalaries('monthly')" placeholder="e.g., 300000">
          </div>
        </div>

        <div id="annual-group" style="display:none;">
          <div class="form-group">
            <div class="label-with-icon">
              <label for="annual" id="label-annual">Annual Gross Salary (¬•)</label>
            </div>
            <input type="number" id="annual" oninput="syncSalaries('annual')" placeholder="e.g., 3600000">
          </div>
        </div>
    </div>
    
    <hr>
    
    <!-- --- CALCULATION BREAKDOWN --- -->
    <div class="results-grid">
      <div class="form-group">
        <div class="label-with-icon">
          <label for="result-annual" id="label-calc-annual">Calculated Annual Salary</label>
          <i class="info-icon">i</i>
          <span class="tooltiptext" id="tooltip-calc-annual">This is your total gross annual salary, used as the starting point for all calculations.</span>
        </div>
        <input type="text" id="result-annual" readonly>
      </div>
      
      <div class="form-group">
        <div class="label-with-icon">
          <span class="icon deduction-icon">üîª</span>
          <label for="result-deduction" id="label-deduction">Salary Income Deduction</label>
          <i class="info-icon">i</i>
          <span class="tooltiptext" id="tooltip-deduction">A standard deduction provided to all salaried employees. The amount depends on your income level.</span>
        </div>
        <input type="text" id="result-deduction" readonly>
      </div>

      <div class="form-group">
        <div class="label-with-icon">
          <span class="icon deduction-icon">üîª</span>
          <label for="social-insurance" id="label-insurance">Social Insurance Premiums</label>
           <i class="info-icon">i</i>
           <span class="tooltiptext" id="tooltip-insurance">Estimated at ~15% of gross income (health, pension, etc.). You can edit this for a more accurate value.</span>
        </div>
        <input type="text" id="social-insurance" oninput="updateTaxableIncome()">
      </div>
      
      <div class="form-group">
        <div class="label-with-icon">
          <span class="icon deduction-icon">üîª</span>
          <label for="basic-deduction" id="label-basic-deduction">Basic Deduction</label>
          <i class="info-icon">i</i>
          <span class="tooltiptext" id="tooltip-basic-deduction">A fixed deduction of ¬•430,000 applicable to most residents for residence tax calculation.</span>
        </div>
        <input type="text" id="basic-deduction" readonly>
      </div>
    </div>

    <!-- --- FINAL TAX ESTIMATE --- -->
    <div class="form-group">
      <div class="label-with-icon">
        <span class="icon result-icon">üí°</span>
        <label for="taxable-income" id="label-taxable">Taxable Income</label>
        <i class="info-icon">i</i>
        <span class="tooltiptext" id="tooltip-taxable">This is the final amount your tax is calculated on. (Annual Salary - All Deductions).</span>
      </div>
      <input type="text" id="taxable-income" readonly>
    </div>
    
    <div class="results-grid">
      <div class="form-group">
        <div class="label-with-icon">
          <span class="icon result-icon">üí∞</span>
          <label for="income-tax" id="label-income-tax">Income-based Resident Tax (10%)</label>
          <i class="info-icon">i</i>
          <span class="tooltiptext" id="tooltip-income-tax">Calculated as 10% of your taxable income (6% for municipal, 4% for prefectural).</span>
        </div>
        <input type="text" id="income-tax" readonly>
      </div>
      
      <div class="form-group">
        <div class="label-with-icon">
          <span class="icon result-icon">üèôÔ∏è</span>
          <label for="per-capita" id="label-per-capita">Per Capita Resident Tax</label>
          <i class="info-icon">i</i>
          <span class="tooltiptext" id="tooltip-per-capita">A small, fixed annual amount. Typically around ¬•5,000.</span>
        </div>
        <input type="text" id="per-capita" readonly>
      </div>
    </div>

    <div class="form-group">
        <div class="label-with-icon">
          <span class="icon result-icon">üßæ</span>
          <label for="total-resident-tax" id="label-total-tax">Total Estimated Annual Resident Tax</label>
          <i class="info-icon">i</i>
          <span class="tooltiptext" id="tooltip-total-tax">The total amount of resident tax you'll likely pay for the year. (Income-based + Per Capita).</span>
        </div>
        <input type="text" id="total-resident-tax" readonly style="font-size: 20px; text-align: center; color: var(--success-color);">
    </div>
  </div>

  <footer>
    <span id="footer-text">¬© 2025 Japan Tax Helper. For educational purposes only.</span>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {

      const translations = {
        en: {
          'main-title': 'Japan Tax Calculator',
          'subtitle': 'A simple and visual breakdown of your Japanese tax components.',
          'label-input-type': 'Select Input Type:',
          'option-monthly': 'Monthly Gross Salary',
          'option-annual': 'Annual Gross Salary',
          'label-monthly': 'Monthly Gross Salary (¬•)',
          'label-annual': 'Annual Gross Salary (¬•)',
          'label-calc-annual': 'Calculated Annual Salary',
          'tooltip-calc-annual': 'This is your total gross annual salary, used as the starting point for all calculations.',
          'label-deduction': 'Salary Income Deduction',
          'tooltip-deduction': 'A standard deduction provided to all salaried employees. The amount depends on your income level.',
          'label-insurance': 'Social Insurance Premiums',
          'tooltip-insurance': 'Estimated at ~15% of gross income (health, pension, etc.). You can edit this for a more accurate value.',
          'label-basic-deduction': 'Basic Deduction',
          'tooltip-basic-deduction': 'A fixed deduction of ¬•430,000 applicable to most residents for residence tax calculation.',
          'label-taxable': 'Taxable Income',
          'tooltip-taxable': 'This is the final amount your tax is calculated on. (Annual Salary - All Deductions).',
          'label-income-tax': 'Income-based Resident Tax (10%)',
          'tooltip-income-tax': 'Calculated as 10% of your taxable income (6% for municipal, 4% for prefectural).',
          'label-per-capita': 'Per Capita Resident Tax',
          'tooltip-per-capita': 'A small, fixed annual amount. Typically around ¬•5,000.',
          'label-total-tax': 'Total Estimated Annual Resident Tax',
          'tooltip-total-tax': "The total amount of resident tax you'll likely pay for the year. (Income-based + Per Capita).",
          'footer-text': '¬© 2025 Japan Tax Helper. For educational purposes only.'
        },
        jp: {
          'main-title': '‰ΩèÊ∞ëÁ®é„Ç∑„Éü„É•„É¨„Éº„Çø„Éº',
          'subtitle': 'Êó•Êú¨„ÅÆÁ®éÈáë„ÅÆ‰ªïÁµÑ„Åø„ÇíÂàÜ„Åã„Çä„ÇÑ„Åô„ÅèÂèØË¶ñÂåñ„Åó„Åæ„Åô„ÄÇ',
          'label-input-type': 'ÂÖ•Âäõ„Çø„Ç§„Éó„ÅÆÈÅ∏Êäû:',
          'option-monthly': 'ÊúàÂèéÔºà„Ç∞„É≠„ÇπÔºâ',
          'option-annual': 'Âπ¥ÂèéÔºà„Ç∞„É≠„ÇπÔºâ',
          'label-monthly': 'ÊúàÂèéÔºà„Ç∞„É≠„ÇπÔºâ(ÂÜÜ)',
          'label-annual': 'Âπ¥ÂèéÔºà„Ç∞„É≠„ÇπÔºâ(ÂÜÜ)',
          'label-calc-annual': 'Ë®àÁÆóÂæå„ÅÆÂπ¥Âèé',
          'tooltip-calc-annual': 'Ë®àÁÆó„ÅÆÂü∫ÁÇπ„Å®„Å™„Çã„ÄÅÁ®éÂºïÂâç„ÅÆÂπ¥ÈñìÁ∑èÊîØÁµ¶È°ç„Åß„Åô„ÄÇ',
          'label-deduction': 'Áµ¶‰∏éÊâÄÂæóÊéßÈô§',
          'tooltip-deduction': 'Áµ¶‰∏éÊâÄÂæóËÄÖ„Å´ÈÅ©Áî®„Åï„Çå„ÇãÊ®ôÊ∫ñÁöÑ„Å™ÊéßÈô§„Åß„Åô„ÄÇÈáëÈ°ç„ÅØÂèéÂÖ•„Å´Âøú„Åò„Å¶Â§âÂãï„Åó„Åæ„Åô„ÄÇ',
          'label-insurance': 'Á§æ‰ºö‰øùÈô∫ÊñôÊéßÈô§',
          'tooltip-insurance': 'Âπ¥Âèé„ÅÆÁ¥Ñ15%„Å®Êé®ÂÆöÔºàÂÅ•Â∫∑‰øùÈô∫„ÄÅÂπ¥ÈáëÁ≠âÔºâ„ÄÇ„Çà„ÇäÊ≠£Á¢∫„Å™ÂÄ§„Å´Á∑®ÈõÜÂèØËÉΩ„Åß„Åô„ÄÇ',
          'label-basic-deduction': 'Âü∫Á§éÊéßÈô§',
          'tooltip-basic-deduction': '‰ΩèÊ∞ëÁ®éË®àÁÆó„Å´„Åä„ÅÑ„Å¶„ÄÅ„Åª„Å®„Çì„Å©„ÅÆÂ±Ö‰ΩèËÄÖ„Å´ÈÅ©Áî®„Åï„Çå„Çã43‰∏áÂÜÜ„ÅÆÂÆöÈ°çÊéßÈô§„Åß„Åô„ÄÇ',
          'label-taxable': 'Ë™≤Á®éÊâÄÂæóÈáëÈ°ç',
          'tooltip-taxable': 'Á®éÈáë„ÅåË®àÁÆó„Åï„Çå„ÇãÊúÄÁµÇÁöÑ„Å™ÈáëÈ°ç„Åß„Åô„ÄÇ(Âπ¥Âèé - ÂÖ®„Å¶„ÅÆÊéßÈô§)„ÄÇ',
          'label-income-tax': 'ÊâÄÂæóÂâ≤ (10%)',
          'tooltip-income-tax': 'Ë™≤Á®éÊâÄÂæó„ÅÆ10%„ÅßË®àÁÆó„Åï„Çå„Åæ„Åô (Â∏ÇÁî∫ÊùëÊ∞ëÁ®é6% + ÈÉΩÈÅìÂ∫úÁúåÊ∞ëÁ®é4%)„ÄÇ',
          'label-per-capita': 'ÂùáÁ≠âÂâ≤',
          'tooltip-per-capita': 'ÂÆöÈ°ç„ÅßË™≤„Åï„Çå„ÇãÂ∞ëÈ°ç„ÅÆÂπ¥Á®é„ÄÇÈÄöÂ∏∏5,000ÂÜÜÁ®ãÂ∫¶„Åß„Åô„ÄÇ',
          'label-total-tax': '‰ΩèÊ∞ëÁ®é„ÅÆÂπ¥ÈñìÂêàË®àÔºàÁõÆÂÆâÔºâ',
          'tooltip-total-tax': 'Âπ¥Èñì„Å´ÊîØÊâï„ÅÜ‰ΩèÊ∞ëÁ®é„ÅÆÂêàË®àÈ°ç„Åß„Åô„ÄÇ(ÊâÄÂæóÂâ≤ + ÂùáÁ≠âÂâ≤)„ÄÇ',
          'footer-text': '¬© 2025 Japan Tax Helper. ÊïôËÇ≤ÁõÆÁöÑ„Åß„ÅÆ„Åø„ÅîÂà©Áî®„Åè„Å†„Åï„ÅÑ„ÄÇ'
        }
      };

      window.toggleLanguage = function(lang) {
        for (const id in translations[lang]) {
          const element = document.getElementById(id);
          if (element) {
            if (element.tagName === 'INPUT' || element.tagName === 'OPTION') {
              element.textContent = translations[lang][id];
            } else {
              element.innerHTML = translations[lang][id];
            }
          }
        }
        document.querySelectorAll('.lang-toggle button').forEach(btn => btn.classList.remove('active'));
        document.getElementById(`btn-${lang}`).classList.add('active');
      };

      window.updateInputMode = function() {
        const mode = document.getElementById("input-mode").value;
        document.getElementById("monthly-group").style.display = (mode === 'monthly') ? 'block' : 'none';
        document.getElementById("annual-group").style.display = (mode === 'annual') ? 'block' : 'none';
        if (mode === 'monthly') {
            document.getElementById("annual-group").style.gridColumn = 'auto';
            document.getElementById("monthly-group").style.gridColumn = '1 / -1';
        } else {
            document.getElementById("monthly-group").style.gridColumn = 'auto';
            document.getElementById("annual-group").style.gridColumn = '1 / -1';
        }
        syncSalaries(mode);
      };

      window.syncSalaries = function(source) {
        let monthly = parseInt(document.getElementById("monthly").value) || 0;
        let annual = parseInt(document.getElementById("annual").value) || 0;

        if (source === 'monthly') {
          annual = monthly * 12;
          document.getElementById("annual").value = annual > 0 ? annual : '';
        } else if (source === 'annual') {
          monthly = Math.round(annual / 12);
          document.getElementById("monthly").value = monthly > 0 ? monthly : '';
        }
        
        // No input, clear fields
        if (annual === 0) {
          clearFields();
          return;
        }

        // --- Salary Income Deduction Calculation (Áµ¶‰∏éÊâÄÂæóÊéßÈô§) ---
        // Based on 2020 NTA guidelines.
        let deduction = 0;
        if (annual <= 1625000) {
          deduction = 550000;
        } else if (annual <= 1800000) {
          deduction = annual * 0.4 - 100000;
        } else if (annual <= 3600000) {
          deduction = annual * 0.3 + 80000;
        } else if (annual <= 6600000) {
          deduction = annual * 0.2 + 440000;
        } else if (annual <= 8500000) {
          deduction = annual * 0.1 + 1100000;
        } else {
          deduction = 1950000;
        }
        deduction = Math.round(deduction);

        // --- Other Deductions ---
        const basicDeduction = 430000; // For resident tax (‰ΩèÊ∞ëÁ®é)
        const estimatedInsurance = Math.round(annual * 0.15); // A common estimate

        // --- Update UI ---
        document.getElementById("social-insurance").value = estimatedInsurance.toLocaleString();
        document.getElementById("result-annual").value = `¬• ${annual.toLocaleString()}`;
        document.getElementById("result-deduction").value = `¬• ${deduction.toLocaleString()}`;
        document.getElementById("basic-deduction").value = `¬• ${basicDeduction.toLocaleString()}`;

        updateTaxableIncome();
      };

      window.updateTaxableIncome = function() {
        let annual = parseInt(document.getElementById("annual").value.replace(/,/g, "")) || 0;
        if (annual === 0) return;

        let salaryDeduction = parseInt(document.getElementById("result-deduction").value.replace(/[¬•, ]/g, "")) || 0;
        let insurance = parseInt(document.getElementById("social-insurance").value.replace(/[¬•, ]/g, "")) || 0;
        let basic = parseInt(document.getElementById("basic-deduction").value.replace(/[¬•, ]/g, "")) || 0;

        const taxable = Math.max(0, annual - salaryDeduction - insurance - basic);
        const incomeBasedTax = Math.round(taxable * 0.1); // 10% rate for resident tax
        const perCapitaTax = 5000; // Standard amount
        const totalResidentTax = incomeBasedTax + perCapitaTax;

        document.getElementById("taxable-income").value = `¬• ${taxable.toLocaleString()}`;
        document.getElementById("income-tax").value = `¬• ${incomeBasedTax.toLocaleString()}`;
        document.getElementById("per-capita").value = `¬• ${perCapitaTax.toLocaleString()}`;
        document.getElementById("total-resident-tax").value = `¬• ${totalResidentTax.toLocaleString()}`;
      };
      
      function clearFields() {
          const ids = ["result-annual", "result-deduction", "social-insurance", "basic-deduction", "taxable-income", "income-tax", "per-capita", "total-resident-tax"];
          ids.forEach(id => document.getElementById(id).value = '');
      }

      // Initial setup
      updateInputMode();
    });
  </script>
</body>
</html>